<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Necromancer</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">InfoSec CTF </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/ctf.html">CTF</a></li>
                </ul>
                </nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/necromancer.html" rel="bookmark"
           title="Permalink to Necromancer">Necromancer</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <span>Thu 14 July 2016</span>

</footer><!-- /.post-info -->      <p><strong>This is a Necromancer challenge from vulnhub.com. You can obtain the virtual
machine from: <a href="https://www.vulnhub.com/entry/the-necromancer-1,154/">here</a></strong></p>
<p>We found our target with:</p>
<div class="highlight"><pre><span></span>netdiscover -r 10.0.0.1/24
</pre></div>


<p>As usual scan the target:</p>
<div class="highlight"><pre><span></span>nmap -sS -T5 -Pn -n 10.0.0.137
</pre></div>


<p>Didn't find anything so lets look for all ports:</p>
<div class="highlight"><pre><span></span>nmap -sS -T5 -Pn -n -p- 10.0.0.137
</pre></div>


<p>There is no open TCP ports on the target. So let's look to the udp:</p>
<div class="highlight"><pre><span></span>nmap -sU -T5 -Pn -n -p- 10.0.0.137
</pre></div>


<p>Only single 666(doom) Udp port open...</p>
<p>So i try to connect to port 666 with ncat with no result... At this point i
stuck a little bit :) but finally decide to listen for trafic from the target.
Fire up wireshark and start sniffing. Found this interesting packets:
<img alt="" src="images/Necromancer/0_find_connection_wireshark.png" /></p>
<p>Lets catch incoming connection with ncat and see what will happen:
<img alt="" src="images/Necromancer/1_ncat_catch_4444.png" /></p>
<p>Got some jiberish string... I paste it in my Owasp Zap and able to decode it as
base 64:
<img alt="" src="images/Necromancer/2_decrypt_base64.png" /></p>
<p>The full text is bellow:
<img alt="" src="images/Necromancer/2_decrypt_base64_txt.png" />
It's talk about send some string to the 666udp. After a while i ended up send
decoded flag1 (opensesame) to the Udp 666 on the target:
<img alt="" src="images/Necromancer/3_send_flag1_to_666.png" /></p>
<p>This is give as flag2 and said something about close 666 and open 80. So nmap
confirm port 80 on the target is open it's time to browse the site.
<img alt="" src="images/Necromancer/3_1_picture_on_site.png" />
I scan with nikto, looking around with firebug and found nothing interesting. It
should be something about the picture so i download it and look carefully on it.
<img alt="" src="images/Necromancer/4_file_picture.png" /></p>
<p><img alt="" src="images/Necromancer/5_strings_picture.png" /></p>
<p><img alt="" src="images/Necromancer/5_1_binwalk_picture.png" />
Looks like there is zip archive in the picture so after unzip the pic we recived
feathers.txt contained base64 string. Decide to use my universal Zap to decode
it and there is flag number 3 and some directory:
<img alt="" src="images/Necromancer/6_decode_flag3_with_zap.png" /></p>
<p>I explore the recently founded directory, there is a second picture. I examine
this picture for a long time but unable to find anything in it. At this point i
stuck big time! Run a lot of scans and fuzzers but unable to find anything. So i
was force to look of walkthrough of someone to get some type of joker. Quikly i 
see other dudes able to find talisman file after fuzzed the target. That's 
strange because I run dirbuster with alot of dictonaries, but that didn't work 
for me. Look like dirbuster didn't work. So after I already know what to look 
for I quickly switch to wfuzz using same dictonary as in dirbuster but wfuzz
found what I searched:
<img alt="" src="images/Necromancer/7_wfuzz_found_talisman.png" />
We found talisman :) At first it's look like binary file. Stucked again! So i
decide to go to sleep and fight tomorrow witch a fresh head.</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="https://www.vulnhub.com">vulnhub</a></li>
                            <li><a href="#"></a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href=""></a></li>
                            <li><a href="https://github.com/NikolaPavlov/">github</a></li>
                            <li><a href="www.twitter.com/gggg">twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

</body>
</html>